Return-Path: <linux-btrfs-owner@vger.kernel.org>
X-Original-To: lists+linux-btrfs@lfdr.de
Delivered-To: lists+linux-btrfs@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 1539D752C62
	for <lists+linux-btrfs@lfdr.de>; Thu, 13 Jul 2023 23:48:41 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S232796AbjGMVsj (ORCPT <rfc822;lists+linux-btrfs@lfdr.de>);
        Thu, 13 Jul 2023 17:48:39 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:48820 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230027AbjGMVsj (ORCPT
        <rfc822;linux-btrfs@vger.kernel.org>);
        Thu, 13 Jul 2023 17:48:39 -0400
X-Greylist: delayed 511 seconds by postgrey-1.37 at lindbergh.monkeyblade.net; Thu, 13 Jul 2023 14:48:36 PDT
Received: from mail.physik.uni-muenchen.de (mail.physik.uni-muenchen.de [IPv6:2001:4ca0:4102::2:129])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id C9DDC19A7
        for <linux-btrfs@vger.kernel.org>; Thu, 13 Jul 2023 14:48:36 -0700 (PDT)
X-Virus-Scanned: amavisd-new at physik.uni-muenchen.de
Message-ID: <f5354da0cd977cf8958a3dafea30c8ed63b425f7.camel@lmu.de>
Subject: Re: how do i restore a single file from a snapshot ?
From:   Christoph Anton Mitterer <christoph.anton.mitterer@lmu.de>
To:     Btrfs BTRFS <linux-btrfs@vger.kernel.org>
Cc:     Bernd Lentes <bernd.lentes@helmholtz-muenchen.de>
Date:   Thu, 13 Jul 2023 23:39:58 +0200
In-Reply-To: <PR3PR04MB7340EB61443EC55A38734D35D637A@PR3PR04MB7340.eurprd04.prod.outlook.com>
References: <PR3PR04MB7340EB61443EC55A38734D35D637A@PR3PR04MB7340.eurprd04.prod.outlook.com>
Organization: =?ISO-8859-1?Q?Ludwig-Maximilians-Unive?=
 =?ISO-8859-1?Q?rsit=E4t?= =?ISO-8859-1?Q?_M=FCnchen?=
Content-Type: multipart/signed; micalg="sha-512"; protocol="application/pkcs7-signature";
        boundary="=-pS6lUw+v7JkWLWMy5SWl"
MIME-Version: 1.0
X-Spam-Status: No, score=-0.0 required=5.0 tests=BAYES_20,
        RCVD_IN_DNSWL_BLOCKED,SPF_HELO_PASS,SPF_NONE,T_SCC_BODY_TEXT_LINE
        autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-btrfs.vger.kernel.org>
X-Mailing-List: linux-btrfs@vger.kernel.org


--=-pS6lUw+v7JkWLWMy5SWl
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

On Thu, 2023-07-13 at 21:30 +0000, Bernd Lentes wrote:
> Let's assume i need to restore a file from 12072023. How can i
> achieve that ?
> Just cp the file from the snapshot over the original ? cp with --
> reflink ?

Sure... if you want to keep (most) other attributes (like dates) use cp
-a.

--reflink makes sense (not in terms of recovery, but in terms of space
usage), but should default anyway to =3Dauto with recent enough
coreutils.


> Delete or rename the original before ?

If by original you mean the "current" file ... and if you want to keep
it, sure then rename it before.
If you don't want to keep... cp will just overwrite (possibly asking
for confirmation).


> Mount the snapshot before cp ?

Well if you don't see the snapshotted file you won't be able to copy it
^^... so yes, mount if not already done so.


Cheers,
Chris.

--=-pS6lUw+v7JkWLWMy5SWl
Content-Type: application/pkcs7-signature; name="smime.p7s"
Content-Disposition: attachment; filename="smime.p7s"
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgMFADCABgkqhkiG9w0BBwEAAKCCFKYw
ggbaMIIEwqADAgECAhEA/ucAQEKEKxsEZT27ihOTdTANBgkqhkiG9w0BAQwFADBGMQswCQYDVQQG
EwJOTDEZMBcGA1UEChMQR0VBTlQgVmVyZW5pZ2luZzEcMBoGA1UEAxMTR0VBTlQgUGVyc29uYWwg
Q0EgNDAeFw0yMjA3MTIwMDAwMDBaFw0yNTA3MTEyMzU5NTlaMIHJMQ4wDAYDVQQREwU4MDUzOTEx
MC8GA1UEChMoTHVkd2lnLU1heGltaWxpYW5zLVVuaXZlcnNpdGFldCBNdWVuY2hlbjEjMCEGA1UE
CRMaR2VzY2h3aXN0ZXItU2Nob2xsLVBsYXR6IDExDzANBgNVBAgTBkJheWVybjELMAkGA1UEBhMC
REUxITAfBgNVBAMTGENocmlzdG9waCBBbnRvbiBNaXR0ZXJlcjEeMBwGCSqGSIb3DQEJARYPbWl0
dGVyZXJAbG11LmRlMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEA2dRCGux2Cq8coTJG
4Wzexsv6pK+5s81jBTwu/EqOyxlQmay4rwGlAb4zM9R8uyFMgtQSx7KUOVLL89D/5Csn/jIl4etd
w6sTncGfD03iOLV0fVLnouXb6k8C6zXKv0MmUc3yP0Ke5Erx4/KvNEAhT0pkmPtp/iTkGbSgtECJ
RLmMd65D6Ot+UssqdA6ZZEmRfaf1ZLzqCPvrurlxxgWufFUdDA2meJR6GG0u+psyP55iwGJuUgf2
76IbV+DATZ4iG8XdUmOPFelCfNaSs1z0qXI4mkg1Vo8Rd4HIca1xX0rSBcvZJxmk3Yvvbob5VNrY
NKSK0wSqHWPE7T1cVO+zS+UPEJs5u5AL6hkKRjSvZSywrfk9GWTwCR8sefy+mN6tzCEbaoClZYnP
BeThkby/mKQUOw/Jfh4Y9VjxVZf9Ma9b2l7v12zX4gXx315fFNTSnhANP4j8x7/05gJQ543m/7Qh
hDikWPh5kB4RjKXC21dgjpw+2rdaeYmOw4eXmBeZAgMBAAGjggG9MIIBuTAfBgNVHSMEGDAWgBRp
AKHHIVj44MUbILAK3adRvxPZ5DAdBgNVHQ4EFgQUslpXZyaYmQibJW9spHhbtIfZ/5gwDgYDVR0P
AQH/BAQDAgWgMAwGA1UdEwEB/wQCMAAwHQYDVR0lBBYwFAYIKwYBBQUHAwQGCCsGAQUFBwMCMD8G
A1UdIAQ4MDYwNAYLKwYBBAGyMQECAk8wJTAjBggrBgEFBQcCARYXaHR0cHM6Ly9zZWN0aWdvLmNv
bS9DUFMwQgYDVR0fBDswOTA3oDWgM4YxaHR0cDovL0dFQU5ULmNybC5zZWN0aWdvLmNvbS9HRUFO
VFBlcnNvbmFsQ0E0LmNybDB4BggrBgEFBQcBAQRsMGowPQYIKwYBBQUHMAKGMWh0dHA6Ly9HRUFO
VC5jcnQuc2VjdGlnby5jb20vR0VBTlRQZXJzb25hbENBNC5jcnQwKQYIKwYBBQUHMAGGHWh0dHA6
Ly9HRUFOVC5vY3NwLnNlY3RpZ28uY29tMDsGA1UdEQQ0MDKBH0NocmlzdG9waC5BbnRvbi5NaXR0
ZXJlckBsbXUuZGWBD21pdHRlcmVyQGxtdS5kZTANBgkqhkiG9w0BAQwFAAOCAgEAgjfSq/5ncOVE
8PBMxFzH4UvjdaSLmqxNp5xexutn9ELqBzK3p7X6+RgxZkjcb0V1oxhYbnpiJ47xkL+tbIwbf1I7
v1TKFYkMxQKqD3M/B/ztgFTALoowEmSxZP6/aZy/fMYuIyYRf9VqGQYuJZds/0ODDwDV91L10fd3
A+6P/OcVj9zIY8AuZmQlGy9KQHx8r+JTUcmyWBSDBtiMCYCrp0tTPcetnqGuLoE0D5sbVJ5YSpx/
DMe3xRVTjRNgGmnuraIiplzg3G0gNzKraCtrCtPexqxnwUXYDVb6b5+egi+gBR7h2hVdYfh0a5ys
7ZVuB2qayNDFvYuMY5Au45hSg0ffDh4kG0jHaEHUHpqEtnHFGgDuNbibDyD0UJnmRfmZvgA4hJgD
7nX4gM5ObfnKZn/xSsUDuh3emMjNLzfX87590GZU0rFs+Oo+LrcgYc5ZqUCx91CXsC3lIEKQedFH
Zb/FEjpxxiN0SA4Js9VGvLDWp7NAsp71f8n8HoMR4BRfI1PdTAwDx2TVPxYb63froyzcwVxyhxGW
vuYLPMg9Pp/1fW3oGKkt7LN3qFt9R8hPBH1Vp4OCoMKHGjo80t8PN359i3zPuFDy5nSOTSRck1ZV
ZrQv3cxKYWZgv8CH5Ek7PJJ2+Xlfdff9rqcqIBrOKUH235FHbma+9Gb03D+Tu7IwggbaMIIEwqAD
AgECAhEA/ucAQEKEKxsEZT27ihOTdTANBgkqhkiG9w0BAQwFADBGMQswCQYDVQQGEwJOTDEZMBcG
A1UEChMQR0VBTlQgVmVyZW5pZ2luZzEcMBoGA1UEAxMTR0VBTlQgUGVyc29uYWwgQ0EgNDAeFw0y
MjA3MTIwMDAwMDBaFw0yNTA3MTEyMzU5NTlaMIHJMQ4wDAYDVQQREwU4MDUzOTExMC8GA1UEChMo
THVkd2lnLU1heGltaWxpYW5zLVVuaXZlcnNpdGFldCBNdWVuY2hlbjEjMCEGA1UECRMaR2VzY2h3
aXN0ZXItU2Nob2xsLVBsYXR6IDExDzANBgNVBAgTBkJheWVybjELMAkGA1UEBhMCREUxITAfBgNV
BAMTGENocmlzdG9waCBBbnRvbiBNaXR0ZXJlcjEeMBwGCSqGSIb3DQEJARYPbWl0dGVyZXJAbG11
LmRlMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEA2dRCGux2Cq8coTJG4Wzexsv6pK+5
s81jBTwu/EqOyxlQmay4rwGlAb4zM9R8uyFMgtQSx7KUOVLL89D/5Csn/jIl4etdw6sTncGfD03i
OLV0fVLnouXb6k8C6zXKv0MmUc3yP0Ke5Erx4/KvNEAhT0pkmPtp/iTkGbSgtECJRLmMd65D6Ot+
UssqdA6ZZEmRfaf1ZLzqCPvrurlxxgWufFUdDA2meJR6GG0u+psyP55iwGJuUgf276IbV+DATZ4i
G8XdUmOPFelCfNaSs1z0qXI4mkg1Vo8Rd4HIca1xX0rSBcvZJxmk3Yvvbob5VNrYNKSK0wSqHWPE
7T1cVO+zS+UPEJs5u5AL6hkKRjSvZSywrfk9GWTwCR8sefy+mN6tzCEbaoClZYnPBeThkby/mKQU
Ow/Jfh4Y9VjxVZf9Ma9b2l7v12zX4gXx315fFNTSnhANP4j8x7/05gJQ543m/7QhhDikWPh5kB4R
jKXC21dgjpw+2rdaeYmOw4eXmBeZAgMBAAGjggG9MIIBuTAfBgNVHSMEGDAWgBRpAKHHIVj44MUb
ILAK3adRvxPZ5DAdBgNVHQ4EFgQUslpXZyaYmQibJW9spHhbtIfZ/5gwDgYDVR0PAQH/BAQDAgWg
MAwGA1UdEwEB/wQCMAAwHQYDVR0lBBYwFAYIKwYBBQUHAwQGCCsGAQUFBwMCMD8GA1UdIAQ4MDYw
NAYLKwYBBAGyMQECAk8wJTAjBggrBgEFBQcCARYXaHR0cHM6Ly9zZWN0aWdvLmNvbS9DUFMwQgYD
VR0fBDswOTA3oDWgM4YxaHR0cDovL0dFQU5ULmNybC5zZWN0aWdvLmNvbS9HRUFOVFBlcnNvbmFs
Q0E0LmNybDB4BggrBgEFBQcBAQRsMGowPQYIKwYBBQUHMAKGMWh0dHA6Ly9HRUFOVC5jcnQuc2Vj
dGlnby5jb20vR0VBTlRQZXJzb25hbENBNC5jcnQwKQYIKwYBBQUHMAGGHWh0dHA6Ly9HRUFOVC5v
Y3NwLnNlY3RpZ28uY29tMDsGA1UdEQQ0MDKBH0NocmlzdG9waC5BbnRvbi5NaXR0ZXJlckBsbXUu
ZGWBD21pdHRlcmVyQGxtdS5kZTANBgkqhkiG9w0BAQwFAAOCAgEAgjfSq/5ncOVE8PBMxFzH4Uvj
daSLmqxNp5xexutn9ELqBzK3p7X6+RgxZkjcb0V1oxhYbnpiJ47xkL+tbIwbf1I7v1TKFYkMxQKq
D3M/B/ztgFTALoowEmSxZP6/aZy/fMYuIyYRf9VqGQYuJZds/0ODDwDV91L10fd3A+6P/OcVj9zI
Y8AuZmQlGy9KQHx8r+JTUcmyWBSDBtiMCYCrp0tTPcetnqGuLoE0D5sbVJ5YSpx/DMe3xRVTjRNg
GmnuraIiplzg3G0gNzKraCtrCtPexqxnwUXYDVb6b5+egi+gBR7h2hVdYfh0a5ys7ZVuB2qayNDF
vYuMY5Au45hSg0ffDh4kG0jHaEHUHpqEtnHFGgDuNbibDyD0UJnmRfmZvgA4hJgD7nX4gM5ObfnK
Zn/xSsUDuh3emMjNLzfX87590GZU0rFs+Oo+LrcgYc5ZqUCx91CXsC3lIEKQedFHZb/FEjpxxiN0
SA4Js9VGvLDWp7NAsp71f8n8HoMR4BRfI1PdTAwDx2TVPxYb63froyzcwVxyhxGWvuYLPMg9Pp/1
fW3oGKkt7LN3qFt9R8hPBH1Vp4OCoMKHGjo80t8PN359i3zPuFDy5nSOTSRck1ZVZrQv3cxKYWZg
v8CH5Ek7PJJ2+Xlfdff9rqcqIBrOKUH235FHbma+9Gb03D+Tu7IwggbmMIIEzqADAgECAhAxAnDU
Nb6bJJr4VtDh4oVJMA0GCSqGSIb3DQEBDAUAMIGIMQswCQYDVQQGEwJVUzETMBEGA1UECBMKTmV3
IEplcnNleTEUMBIGA1UEBxMLSmVyc2V5IENpdHkxHjAcBgNVBAoTFVRoZSBVU0VSVFJVU1QgTmV0
d29yazEuMCwGA1UEAxMlVVNFUlRydXN0IFJTQSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0y
MDAyMTgwMDAwMDBaFw0zMzA1MDEyMzU5NTlaMEYxCzAJBgNVBAYTAk5MMRkwFwYDVQQKExBHRUFO
VCBWZXJlbmlnaW5nMRwwGgYDVQQDExNHRUFOVCBQZXJzb25hbCBDQSA0MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAs0riIl4nW+kEWxQENTIgFK600jFAxs1QwB6hRMqvnkphfy2Q3mKb
M2otpELKlgE8/3AQPYBo7p7yeORuPMnAuA+oMGRb2wbeSaLcZbpwXgfCvnKxmq97/kQkOFX706F9
O7/h0yehHhDjUdyMyT0zMs4AMBDRrAFn/b2vR3j0BSYgoQs16oSqadM3p+d0vvH/YrRMtOhkvGpL
uzL8m+LTAQWvQJ92NwCyKiHspoP4mLPJvVpEpDMnpDbRUQdftSpZzVKTNORvPrGPRLnJ0EEVCHR8
2LL6oz915WkrgeCY9ImuulBn4uVsd9ZpubCgM/EXvVBlViKqusChSsZEn7juIsGIiDyaIhhLsd3a
mm8BS3bgK6AxdSMROND6hiHT182Lmf8C+gRHxQG9McvG35uUvRu8v7bPZiJRaT7ZC2f50P4lTlnb
LvWpXv5yv7hheO8bMXltiyLweLB+VNvg+GnfL6TW3Aq1yF1yrZAZzR4MbpjTWdEdSLKvz8+0wCws
cQ81nbDOwDt9vyZ+0eJXbRkWZiqScnwAg5/B1NUD4TrYlrI4n6zFp2pyYUOiuzP+as/AZnz63Gvj
FK69WODR2W/TK4D7VikEMhg18vhuRf4hxnWZOy0vhfDR/g3aJbdsGac+diahjEwzyB+UKJOCyzve
cG8bZ/u/U8PsEMZg07iIPi8CAwEAAaOCAYswggGHMB8GA1UdIwQYMBaAFFN5v1qqK0rPVIDh2JvA
nfKyA2bLMB0GA1UdDgQWBBRpAKHHIVj44MUbILAK3adRvxPZ5DAOBgNVHQ8BAf8EBAMCAYYwEgYD
VR0TAQH/BAgwBgEB/wIBADAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwQwOAYDVR0gBDEw
LzAtBgRVHSAAMCUwIwYIKwYBBQUHAgEWF2h0dHBzOi8vc2VjdGlnby5jb20vQ1BTMFAGA1UdHwRJ
MEcwRaBDoEGGP2h0dHA6Ly9jcmwudXNlcnRydXN0LmNvbS9VU0VSVHJ1c3RSU0FDZXJ0aWZpY2F0
aW9uQXV0aG9yaXR5LmNybDB2BggrBgEFBQcBAQRqMGgwPwYIKwYBBQUHMAKGM2h0dHA6Ly9jcnQu
dXNlcnRydXN0LmNvbS9VU0VSVHJ1c3RSU0FBZGRUcnVzdENBLmNydDAlBggrBgEFBQcwAYYZaHR0
cDovL29jc3AudXNlcnRydXN0LmNvbTANBgkqhkiG9w0BAQwFAAOCAgEACgVOew2PHxM5AP1v7GLG
w+3tF6rjAcx43D9Hl110Q+BABABglkrPkES/VyMZsfuds8fcDGvGE3o5UfjSno4sij0xdKut8zMa
zv8/4VMKPCA3EUS0tDUoL01ugDdqwlyXuYizeXyH2ICAQfXMtS+raz7mf741CZvO50OxMUMxqlje
RfVPDJQJNHOYi2pxuxgjKDYx4hdZ9G2o+oLlHhu5+anMDkE8g0tffjRKn8I1D1BmrDdWR/IdbBOj
6870abYvqys1qYlPotv5N5dm+XxQ8vlrvY7+kfQaAYeO3rP1DM8BGdpEqyFVa+I0rpJPhaZkeWW7
cImDQFerHW9bKzBrCC815a3WrEhNpxh72ZJZNs1HYJ+29NTB6uu4NJjaMxpk+g2puNSm4b9uVjBb
PO9V6sFSG+IBqE9ckX/1XjzJtY8Grqoo4SiRb6zcHhp3mxj3oqWi8SKNohAOKnUc7RIP6ss1hqIF
yv0xXZor4N9tnzD0Fo0JDIURjDPEgo5WTdti/MdGTmKFQNqxyZuT9uSI2Xvhz8p+4pCYkiZqpahZ
lHqMFxdw9XRZQgrP+cgtOkWEaiNkRBbvtvLdp7MCL2OsQhQEdEbUvDM9slzZXdI7NjJokVBq3O4p
ls3VD2z3L/bHVBe0rBERjyM2C/HSIh84rfmAqBgklzIOqXhd+4RzadUxggNtMIIDaQIBATBbMEYx
CzAJBgNVBAYTAk5MMRkwFwYDVQQKExBHRUFOVCBWZXJlbmlnaW5nMRwwGgYDVQQDExNHRUFOVCBQ
ZXJzb25hbCBDQSA0AhEA/ucAQEKEKxsEZT27ihOTdTANBglghkgBZQMEAgMFAKCCAWMwGAYJKoZI
hvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMjMwNzEzMjEzOTU4WjBPBgkqhkiG
9w0BCQQxQgRAwGOTjYeMf6+F83qUSfMcOC1xGZhelOebSu9ws2FbQhDsLZT89fHZaRP5B7uYDZkA
/d9IeVzwG9jJ9w5sJ1qyQjBqBgkrBgEEAYI3EAQxXTBbMEYxCzAJBgNVBAYTAk5MMRkwFwYDVQQK
ExBHRUFOVCBWZXJlbmlnaW5nMRwwGgYDVQQDExNHRUFOVCBQZXJzb25hbCBDQSA0AhEA/ucAQEKE
KxsEZT27ihOTdTBsBgsqhkiG9w0BCRACCzFdoFswRjELMAkGA1UEBhMCTkwxGTAXBgNVBAoTEEdF
QU5UIFZlcmVuaWdpbmcxHDAaBgNVBAMTE0dFQU5UIFBlcnNvbmFsIENBIDQCEQD+5wBAQoQrGwRl
PbuKE5N1MA0GCSqGSIb3DQEBAQUABIIBgK5mMq13vEOcNeKWMewqPUM1Wd881rRTk8hI0Gr5R1Yu
lf1RG7wYitoCYDD7v7Zh44jWmCq4nFdvt4KvCtZp2argSVz7650exB5cuI+8XaXM8y7WqiBJyo4s
mhEMYyE2gfvT16dv9b+bYF5CoMYrtPWnvL/CWEj4YDCh50ZMhUyIFn2+kgMQyzA/LaUXRFySRMbm
jepf7PNNUB0rvZofGrg8poivyrYSAwX5AtXyaoX525ikcAQp2y69KrPqt6Edr4JaamR2/LT/aj95
fdcadX8QhUqC9OCig1KSRn3tywsHKC5WOz+x0GdFp0pP2NtvVZLtwpqKgTv+kirFZ80s1iyg1tt5
zgPt0xWkbZjATMCrVzMeEx0l1SfYHetHIsuT1ovAozkwYFBNGmE096CbGw/WuFFVFU583TnV8Mpw
M2Pqg9pFU8OlGJ19awVBgpfy3e0PCURbtyogM+vIPGHTqf4+qFTLvD77uuhOTp+wukm4YtfT0CnP
sMRqYj0/JA0P9wAAAAAAAA==


--=-pS6lUw+v7JkWLWMy5SWl--
